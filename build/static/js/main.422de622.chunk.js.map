{"version":3,"sources":["constants.ts","APIService.ts","scenes/Login.tsx","components/Header.tsx","types.ts","Calculations.ts","scenes/Analysis.tsx","scenes/Overview.tsx","scenes/Positions.tsx","scenes/Trade.tsx","components/Buy.tsx","components/Sell.tsx","scenes/Transactions.tsx","scenes/NavPane.tsx","scenes/SignUp.tsx","App.tsx","reportWebVitals.js","index.js"],"names":["AUTH_TOKEN_KEY","MD5","require","encryptPassword","clearText","hex","createRequestAuthorization","methodType","method","headers","authorization","sessionStorage","getItem","isLoggedIn","doSignup","email","password","name","a","encryptedPassword","console","log","requestOptions","body","JSON","stringify","fetch","response","status","json","doLogin","responseObj","setItem","token","getAccount","account","getUserInfo","userResponseObj","getAssets","assets","getTransactions","transactions","getCash","cash","lookupTicker","tickerSymbol","lookupTickerURL","URL","getTickerLookupParams","URLSearchParams","search","toString","text","getHistoricalPrices","symbol","startDate","queryParams","ticker","date","toDateString","queryURL","buyAsset","shares","price","sharesString","priceString","buySharesURL","buySharesQueryParams","cashRemainingAfterPurchase","successful","remainingCash","sellAsset","sellAssetURL","sellAssetQueryParams","getStockPrice","getStockPriceUrl","getStockPriceQueryParams","getShareCount","asset","stock","lots","totalCount","map","currLot","Login","useState","loggingIn","setLoggingIn","labelCol","span","wrapperCol","initialValues","remember","onFinish","values","username","then","success","info","AntMessage","window","location","assign","error","onFinishFailed","errorInfo","autoComplete","Item","label","rules","required","message","Password","offset","size","type","htmlType","onClick","Header","Container","styled","div","userInfo","setUserInfo","useEffect","style","color","font","textAlign","verticalAlign","paddingTop","TransactionType","getCostBasis","costBasis","lot","basis","getQuantity","quantity","getAssetValue","bid","previousClose","getGain","user","getAccountValue","total","getPercentOfAccount","getGainLoss","formatCurrency","money","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","format","formatPercent","percent","formatDate","long","dateToFormat","Date","isValid","formatStr","getTransactionsOnDate","dateTransactions","setHours","transaction","transactionDate","getTime","push","adjustForSplits","buyOrSell","SPLIT","toUpperCase","to","from","getPortfolioSnapshots","tickerMap","Map","snapshots","endDate","now","setDate","getDate","BUY","get","adjustedShares","undefined","set","amount","DIVIDEND","SELL","GIFT","positions","forEach","priceMap","getPriceHistory","prices","getStockPriceOnDateLocal","history","startDiff","length","Math","abs","endDiff","i","data","getHistoricalValues","snapshot","snapshotDate","stockValues","position","stockValue","value","stocks","clear","calcSharePrice","commission","Chart","register","registerables","lineColors","Analysis","chartData","setChartData","historicalValues","createChartData","portfolioValues","labels","datasets","totalValues","cashValues","originalValues","thinnedValues","interval","dateIdx","floor","thinPortfolioValues","stockValueMap","portfolioValue","key","NaN","id","pointRadius","pointHoverRadius","borderColor","colorId","colorName","className","description","datasetIdKey","Overview","setAccount","loadingAccount","setLoadingUser","loadingUserInfo","setLoadingAccount","foundUserInfo","foundUser","labelAlign","created","getAccountValueString","getGainString","Positions","TradeType","setData","calcData","ask","currentValue","percentOfAccount","gain","dataSource","columns","title","dataIndex","pagination","pageSize","Buy","typedSymbol","setTypedSymbol","sharesToBuy","setSharesToBuy","askPrice","setAskPrice","totalCost","setTotalCost","setShareCost","companyName","setCompanyName","setCash","currentTypedSymbol","useRef","loadingStock","setLoadingStock","loadingPrice","setLoadingPrice","userCash","current","foundCompanyName","foundPrice","catch","ex","shareOnlyCost","handlePurchase","alert","msg","confirm","buyAssetResponse","placeholder","onChange","e","target","typedValue","Number","parseInt","disabled","Sell","setAssets","loadingAssets","setLoadingAssets","setAsset","sharesToSell","setSharesToSell","setPrice","handleSale","foundAssets","foundAsset","find","currAsset","defaultValue","Option","Trade","tradeType","setTradeType","orientation","orientationMargin","Transactions","rows","createDescription","TabPane","Tabs","logoutButton","removeItem","NavPane","paddingLeft","paddingRight","boxSizing","tabBarExtraContent","tabPosition","tab","SignUp","userID","App","path","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.422de622.chunk.js","sourcesContent":["export const AUTH_TOKEN_KEY:string = \"AUTH_TOKEN_KEY\"\r\nexport default {\r\n    AUTH_TOKEN_KEY\r\n}","import { AUTH_TOKEN_KEY } from \"./constants\";\r\nimport {\r\n  Asset,\r\n  Dividend,\r\n  SpotPrice,\r\n  Transaction,\r\n  Account,\r\n  UserInfo,\r\n  HistoricalPrice,\r\n} from \"./types\";\r\nimport fetch, { RequestInit } from \"node-fetch\";\r\nconst Hashes = require(\"jshashes\");\r\nconst MD5 = new Hashes.MD5();\r\n\r\nconst isDevMode = ():boolean => {\r\n  return false;\r\n}\r\n\r\nconst AWS_PREFIX:string = \"http://ec2-54-144-18-145.compute-1.amazonaws.com\"\r\n\r\nconst getURL = (endpoint:string):string => {\r\n  const url:string = isDevMode() ? AWS_PREFIX + endpoint : endpoint;\r\n  return url;\r\n}\r\n\r\nconst encryptPassword = (clearText: string): string => {\r\n  return MD5.hex(clearText);\r\n};\r\n\r\nconst createRequestAuthorization = (methodType = \"GET\"): RequestInit => {\r\n  return {\r\n    method: methodType,\r\n    headers: {\r\n      authorization: `Bearer ${sessionStorage.getItem(AUTH_TOKEN_KEY)}`,\r\n    },\r\n  };\r\n};\r\n\r\nexport const isLoggedIn = (): boolean =>\r\n  !!sessionStorage.getItem(AUTH_TOKEN_KEY);\r\n\r\nexport const doLogout = () => {\r\n  sessionStorage.removeItem(AUTH_TOKEN_KEY);\r\n};\r\n\r\nexport const doSignup = async (\r\n  email: string,\r\n  password: string,\r\n  name: string\r\n): Promise<boolean> => {\r\n  const encryptedPassword: string = encryptPassword(password);\r\n  console.log(\r\n    \"signing up with clear password = \",\r\n    password,\r\n    \", encrypted =\",\r\n    encryptedPassword\r\n  );\r\n\r\n  const requestOptions = {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify({\r\n      email: email,\r\n      password: encryptedPassword,\r\n      name: name,\r\n    }),\r\n  };\r\n  const response = await fetch(getURL(\"/API/signup\"), requestOptions);\r\n\r\n  const status: number = response.status;\r\n  const json: string = await response.json();\r\n\r\n  if (status === 200) {\r\n    return true;\r\n  } else {\r\n    console.log(\"Signup failed: \" + JSON.stringify(json));\r\n    return false;\r\n  }\r\n};\r\n\r\nexport const doLogin = async (\r\n  email: string,\r\n  password: string\r\n): Promise<boolean> => {\r\n  const encryptedPassword: string = encryptPassword(password);\r\n\r\n  console.log(\r\n    \"logging in with clear password = \",\r\n    password,\r\n    \", encrypted =\",\r\n    encryptedPassword\r\n  );\r\n  const requestOptions = {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    body: JSON.stringify({ email, password:encryptedPassword }),\r\n  };\r\n  const response = await fetch (getURL(\"/API/login\"), requestOptions);\r\n\r\n  switch (response.status) {\r\n    case 200:\r\n      const responseObj = await response.json();\r\n      sessionStorage.setItem(AUTH_TOKEN_KEY, responseObj.token);\r\n      console.log(\"Successful login: \" + responseObj);\r\n      // TODO log someone in, make it available everywhere\r\n\r\n      return true;\r\n\r\n    case 401:\r\n    case 400:\r\n      // todo: better way to show error\r\n      console.log(\"unsuccessful login for user \" + email);\r\n      return false;\r\n\r\n    default:\r\n      // 500 is possible for critical server erropr\r\n      console.log(\"unexpected login response\");\r\n      return false;\r\n  }\r\n};\r\n\r\nexport const getAccount = async (): Promise<Account | null> => {\r\n  const requestOptions = createRequestAuthorization();\r\n  const response = await fetch(\r\n    getURL(\"/API/getAccount\"),\r\n    requestOptions\r\n  );\r\n\r\n  switch (response.status) {\r\n    case 200:\r\n      const account: Account = await response.json();\r\n      return account;\r\n\r\n    case 401:\r\n      // todo: better way to show error\r\n      console.log(await response.json());\r\n      return null;\r\n\r\n    default:\r\n      // 500 is possible for critical server erropr\r\n      console.log(\"unexpected getAccount response\");\r\n      return null;\r\n  }\r\n};\r\n\r\nexport const getUserInfo = async (): Promise<UserInfo | null> => {\r\n  const requestOptions = createRequestAuthorization();\r\n  const response = await fetch(\r\n    getURL(\"/API/getUserInfo\"),\r\n    requestOptions\r\n  );\r\n\r\n  switch (response.status) {\r\n    case 200:\r\n      const userResponseObj = await response.json();\r\n      return userResponseObj;\r\n\r\n    case 401:\r\n      // todo: better way to show error\r\n      console.log(await response.json());\r\n      return null;\r\n\r\n    default:\r\n      // 500 is possible for critical server erropr\r\n      console.log(\"unexpected getUser response\");\r\n      return null;\r\n  }\r\n};\r\n\r\nexport const getBalance = async (yesterday: boolean): Promise<number> => {\r\n  const requestOptions = createRequestAuthorization();\r\n  const getBalanceUrl = new URL (getURL(\"/API/getBalance\"));\r\n  const getBalanceQueryParams = new URLSearchParams({\r\n    yesterday: `${yesterday}`,\r\n  });\r\n  getBalanceUrl.search = getBalanceQueryParams.toString();\r\n  const response = await fetch(getBalanceUrl, requestOptions);\r\n\r\n  switch (response.status) {\r\n    case 200:\r\n      const userResponseObj = await response.json();\r\n      return userResponseObj.balance;\r\n\r\n    case 401:\r\n      // todo: better way to show error\r\n      console.log(await response.json());\r\n      return userResponseObj;\r\n\r\n    default:\r\n      // 500 is possible for critical server erropr\r\n      console.log(\"unexpected getUser response\");\r\n      return userResponseObj;\r\n  }\r\n};\r\n\r\nexport const getAssets = async (): Promise<Asset[]> => {\r\n  const requestOptions = createRequestAuthorization();\r\n\r\n  const response = await fetch(\r\n    getURL(\"/API/getAssets\"),\r\n    requestOptions\r\n  );\r\n\r\n  switch (response.status) {\r\n    case 200:\r\n      const userResponseObj = await response.json();\r\n\r\n      console.log(\"Assets retrieved: \" + userResponseObj.assets);\r\n      return userResponseObj.assets;\r\n\r\n    case 401:\r\n      // todo: better way to show error\r\n      console.log(await response.json());\r\n      return userResponseObj;\r\n\r\n    default:\r\n      // 500 is possible for critical server erropr\r\n      console.log(\"unexpected getAssets response\");\r\n      return userResponseObj;\r\n  }\r\n};\r\n\r\nexport const getTransactions = async (): Promise<Transaction[]> => {\r\n  const requestOptions = createRequestAuthorization();\r\n\r\n  const response = await fetch(\r\n    getURL(\"/API/getTransactions\"),\r\n    requestOptions\r\n  );\r\n\r\n  switch (response.status) {\r\n    case 200:\r\n      const userResponseObj = await response.json();\r\n\r\n      //console.log(\"Transactions retrieved: \" + userResponseObj.transactions);\r\n      return userResponseObj.transactions;\r\n\r\n    case 401:\r\n      // todo: better way to show error\r\n      console.log(await response.json());\r\n      return userResponseObj;\r\n\r\n    default:\r\n      // 500 is possible for critical server erropr\r\n      console.log(\"unexpected getAssets response\");\r\n      return userResponseObj;\r\n  }\r\n};\r\n\r\nexport const getCash = async (): Promise<number> => {\r\n  const requestOptions = createRequestAuthorization();\r\n\r\n  const response = await fetch(\r\n    getURL(\"/API/getCash\"),\r\n    requestOptions\r\n  );\r\n\r\n  switch (response.status) {\r\n    case 200:\r\n      const userResponseObj = await response.json();\r\n\r\n      console.log(\"Transactions retrieved: \" + userResponseObj.cash);\r\n      return userResponseObj.cash;\r\n\r\n    case 401:\r\n      // todo: better way to show error\r\n      console.log(await response.json());\r\n      return userResponseObj;\r\n\r\n    default:\r\n      // 500 is possible for critical server erropr\r\n      console.log(\"unexpected getAssets response\");\r\n      return userResponseObj;\r\n  }\r\n};\r\n//TODO: don't lookup empty or null string\r\nexport const lookupTicker = async (\r\n  tickerSymbol: string\r\n): Promise<string | null> => {\r\n  console.log(\"Looking up ticker: \" + tickerSymbol + \".......\");\r\n\r\n  // TODO: credentials not needed for stocklookup. ...remove\r\n  const requestOptions = createRequestAuthorization();\r\n\r\n  const lookupTickerURL = new URL (getURL(\"/API/lookupTicker\"));\r\n  const getTickerLookupParams = new URLSearchParams({\r\n    tickerSymbol: tickerSymbol,\r\n  });\r\n  lookupTickerURL.search = getTickerLookupParams.toString();\r\n\r\n  const response = await fetch(lookupTickerURL, requestOptions);\r\n\r\n  console.log(\"ticker lookup: \", response.status, \" - \", response.json);\r\n\r\n  switch (response.status) {\r\n    case 200:\r\n      const userResponseObj: string = await response.text();\r\n      return userResponseObj;\r\n\r\n    case 400:\r\n      // todo: better way to show error\r\n      //console.log(await response.json());\r\n      return null;\r\n\r\n    default:\r\n      // 500 is possible for critical server erropr\r\n      console.log(\"unexpected lookupTicker response\");\r\n      return null;\r\n  }\r\n};\r\n\r\nexport async function getHistoricalDividends(\r\n  symbol: string\r\n): Promise<Dividend[]> {\r\n  const requestOptions = createRequestAuthorization();\r\n\r\n  const queryParams = new URLSearchParams({ ticker: symbol });\r\n\r\n  const queryURL = new URL (getURL(\"/API/getHistoricalDividends\"));\r\n  queryURL.search = queryParams.toString();\r\n\r\n  const response = await fetch(queryURL, requestOptions);\r\n\r\n  switch (response.status) {\r\n    case 200: {\r\n      return await response.json();\r\n    }\r\n\r\n    default:\r\n      // 500 is possible for critical server erropr\r\n      console.log(\"unexpected getDividends response\");\r\n      return [];\r\n  }\r\n}\r\n\r\nexport async function getStockPriceOnDate(\r\n  symbol: string,\r\n  date: Date\r\n): Promise<number> {\r\n  const requestOptions = createRequestAuthorization();\r\n\r\n  const queryParams = new URLSearchParams({\r\n    ticker: symbol,\r\n    date: date.toDateString(),\r\n  });\r\n  const queryURL = new URL (getURL(\"/API/getStockPriceOnDate\"));\r\n  queryURL.search = queryParams.toString();\r\n\r\n  const response = await fetch(queryURL, requestOptions);\r\n  switch (response.status) {\r\n    case 200: {\r\n      const responseObj = await response.json();\r\n\r\n      return responseObj.price;\r\n    }\r\n\r\n    default:\r\n      // 500 is possible for critical server erropr\r\n      console.log(\"unexpected buyAsset response\");\r\n      return 0;\r\n  }\r\n}\r\n\r\nexport async function getHistoricalPrices(\r\n  symbol: string,\r\n  startDate: Date\r\n): Promise<HistoricalPrice[]> {\r\n  const requestOptions = createRequestAuthorization();\r\n\r\n  const queryParams = new URLSearchParams({\r\n    ticker: symbol,\r\n    date: startDate.toDateString(),\r\n  });\r\n  const queryURL = new URL (getURL(\"/API/getHistoricalPrices\"));\r\n  queryURL.search = queryParams.toString();\r\n\r\n  const response = await fetch(queryURL, requestOptions);\r\n  switch (response.status) {\r\n    case 200: {\r\n      const responseObj = await response.json();\r\n      return responseObj\r\n    }\r\n\r\n    default:\r\n      // 500 is possible for critical server erropr\r\n      console.log(\"unexpected buyAsset response\");\r\n      return [];\r\n  }\r\n}\r\n\r\nexport type BuyAssetResponse = {\r\n  successful: boolean;\r\n  remainingCash: number;\r\n};\r\n\r\nexport const buyAsset = async (\r\n  symbol: string,\r\n  shares: number,\r\n  price: number\r\n): Promise<BuyAssetResponse> => {\r\n  // TODO: credentials not needed for stocklookup.remove\r\n  const requestOptions = createRequestAuthorization();\r\n\r\n  const sharesString: string = shares.toString();\r\n  const priceString: string = price.toString();\r\n  const buySharesURL = new URL (getURL(\"/API/buyAsset\"));\r\n  const buySharesQueryParams = new URLSearchParams({\r\n    tickerSymbol: symbol,\r\n    shares: sharesString,\r\n    price: priceString,\r\n  });\r\n  buySharesURL.search = buySharesQueryParams.toString();\r\n\r\n  const response = await fetch(buySharesURL, requestOptions);\r\n\r\n  switch (response.status) {\r\n    case 200: {\r\n      const userResponseObj = await response.json();\r\n      const cashRemainingAfterPurchase: number = userResponseObj.cash;\r\n      return { successful: true, remainingCash: cashRemainingAfterPurchase };\r\n    }\r\n\r\n    default:\r\n      // 500 is possible for critical server erropr\r\n      console.log(\"unexpected buyAsset response\");\r\n      return { successful: false, remainingCash: 0 };\r\n  }\r\n};\r\n\r\nexport type SellAssetResponse = {\r\n  successful: boolean;\r\n  remainingCash?: number;\r\n};\r\n\r\nexport const sellAsset = async (\r\n  symbol: string,\r\n  shares: number,\r\n  price: number\r\n) => {\r\n  const requestOptions = createRequestAuthorization();\r\n\r\n  const sharesString: string = shares.toString();\r\n  const priceString: string = price.toString();\r\n  const sellAssetURL = new URL (getURL(\"/API/sellAsset\"));\r\n  const sellAssetQueryParams = new URLSearchParams({\r\n    tickerSymbol: symbol,\r\n    shares: sharesString,\r\n    price: priceString,\r\n  });\r\n  sellAssetURL.search = sellAssetQueryParams.toString();\r\n\r\n  const response = await fetch(sellAssetURL, requestOptions);\r\n\r\n  console.log(\"response: \", response.status);\r\n\r\n  switch (response.status) {\r\n    case 200: {\r\n      const userResponseObj = await response.json();\r\n      const cashRemainingAfterPurchase: number = userResponseObj.cash;\r\n      return { successful: true, remainingCash: cashRemainingAfterPurchase };\r\n    }\r\n\r\n    default:\r\n      // 500 is possible for critical server erropr\r\n      console.log(\"unexpected getAssets response\");\r\n      return false;\r\n  }\r\n};\r\n\r\nexport const getStockPrice = async (\r\n  tickerSymbol: string\r\n): Promise<SpotPrice> => {\r\n  // TODO: credentials not needed for stocklookup.remove\r\n  const requestOptions = createRequestAuthorization();\r\n\r\n  const getStockPriceUrl = new URL (getURL(\"/API/getStockPrice\"));\r\n  const getStockPriceQueryParams = new URLSearchParams({\r\n    tickerSymbol: tickerSymbol,\r\n  });\r\n  getStockPriceUrl.search = getStockPriceQueryParams.toString();\r\n\r\n  const response = await fetch(getStockPriceUrl, requestOptions);\r\n\r\n  const userResponseObj = await response.json();\r\n  console.log(\"Get Stock Price Response:: \", userResponseObj);\r\n\r\n  switch (response.status) {\r\n    case 200:\r\n      //const userResponseObj = await response.json();\r\n      return userResponseObj;\r\n\r\n    case 401:\r\n      // todo: better way to show error\r\n      console.log(await response.json());\r\n      return userResponseObj;\r\n\r\n    default:\r\n      // 500 is possible for critical server erropr\r\n      console.log(\"unexpected getAssets response\");\r\n      return userResponseObj;\r\n  }\r\n};\r\n\r\nexport const getShareCount = (asset: Asset | null | undefined): number => {\r\n  console.log(\r\n    \"get Share count for \",\r\n    asset?.stock?.symbol,\r\n    \" with \",\r\n    asset?.lots\r\n  );\r\n\r\n  var totalCount: number = 0;\r\n  if (!asset) return 0;\r\n\r\n  asset.lots.map((currLot) => {\r\n    totalCount += currLot.shares;\r\n  });\r\n\r\n  console.log(\" ---> share count = \", totalCount);\r\n  return totalCount;\r\n};\r\n","import { Button, Form, Input, message as AntMessage, Spin } from \"antd\";\r\nimport { useEffect, useState } from \"react\";\r\nimport {\r\n  doLogin,\r\n  getTransactions,\r\n  getUserInfo,\r\n  isLoggedIn,\r\n} from \"../APIService\";\r\nimport \"antd/dist/antd.css\";\r\nimport { UserInfo } from \"../types\";\r\n\r\nfunction Login() {\r\n  const [loggingIn, setLoggingIn] = useState<boolean>(false);\r\n\r\n  // useEffect(() => {\r\n  //   getTransactions().then((transactions) => {\r\n  //     setData(calcData(transactions));\r\n  //   });\r\n  // }, []);\r\n\r\n  const onFinish = (values: any) => {\r\n    setLoggingIn(true);\r\n    doLogin(values.username, values.password).then((success: boolean) => {\r\n      setLoggingIn(false);\r\n      if (!success) {\r\n        AntMessage.error(\"Invalid credentials\");\r\n      } else {\r\n        getUserInfo().then((info: UserInfo | null) => {\r\n          AntMessage.success(\r\n            \"User \" + info?.name + \" successfully logged in\",\r\n            1\r\n          ).then(() => {\r\n            window.location.assign(\"/\");\r\n          });\r\n        });\r\n      }\r\n    });\r\n  };\r\n\r\n  const onFinishFailed = (errorInfo: any) => {\r\n    console.log(\"Failed:\", errorInfo);\r\n  };\r\n\r\n  const onSignUp = () => {\r\n    window.location.assign(\"/signup\");\r\n  };\r\n\r\n  return (\r\n    <Form\r\n      name=\"basic\"\r\n      labelCol={{\r\n        span: 8,\r\n      }}\r\n      wrapperCol={{\r\n        span: 16,\r\n      }}\r\n      initialValues={{\r\n        remember: true,\r\n      }}\r\n      onFinish={onFinish}\r\n      onFinishFailed={onFinishFailed}\r\n      autoComplete=\"off\"\r\n    >\r\n      <Form.Item\r\n        label=\"User name\"\r\n        name=\"username\"\r\n        rules={[\r\n          {\r\n            required: true,\r\n            message: \"Please input your username\",\r\n          },\r\n        ]}\r\n      >\r\n        <Input />\r\n      </Form.Item>\r\n\r\n      <Form.Item\r\n        label=\"Password\"\r\n        name=\"password\"\r\n        rules={[\r\n          {\r\n            required: true,\r\n            message: \"Please input your password!\",\r\n          },\r\n        ]}\r\n      >\r\n        <Input.Password />\r\n      </Form.Item>\r\n\r\n      <Form.Item\r\n        wrapperCol={{\r\n          offset: 8,\r\n          span: 16,\r\n        }}\r\n      >\r\n        {loggingIn || isLoggedIn() ? (\r\n          <Spin size=\"small\" />\r\n        ) : (\r\n          <Button type=\"primary\" htmlType=\"submit\">\r\n            Login\r\n          </Button>\r\n        )}\r\n      </Form.Item>\r\n\r\n      <Form.Item\r\n        wrapperCol={{\r\n          offset: 8,\r\n          span: 16,\r\n        }}\r\n      >\r\n        <label>No Account? </label>\r\n\r\n        <Button type=\"link\" onClick={onSignUp}>\r\n          Sign Up\r\n        </Button>\r\n      </Form.Item>\r\n    </Form>\r\n  );\r\n\r\n  // return (\r\n  //   <div className=\"Login\">\r\n  //     <label> Email </label>\r\n  //     <input name=\"typedEmail\" onChange={handleUserInput} />\r\n  //     <br />\r\n  //     <label> Password </label>\r\n  //     <input name=\"typedPassword\" onChange={handleUserInput} />\r\n  //     <br />\r\n  //     <button onClick={handleLoginButtonClick}>Login</button>\r\n  //     <br />\r\n  //     <label>No account?</label>\r\n  //     <label> Sign Up </label>\r\n  //     <header className=\"Login-header\"></header>\r\n  //   </div>\r\n  // );\r\n}\r\n\r\nexport default Login;\r\n","import { useEffect, useState } from \"react\";\r\nimport styled from \"styled-components/macro\";\r\nimport { getUserInfo, isLoggedIn } from \"../APIService\";\r\nimport { UserInfo } from \"../types\";\r\n\r\nexport default function Header() {\r\n  const Container = styled.div`\r\n    width: 100%;\r\n    height: 70px;\r\n    background-color: green;\r\n  `;\r\n\r\n  const [userInfo, setUserInfo] = useState<UserInfo | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (isLoggedIn() && !userInfo) {\r\n        console.log(\"Getting User Info . Currently it is \", userInfo)\r\n      getUserInfo().then((info: UserInfo | null) => {\r\n        if (info) {\r\n          setUserInfo(info);\r\n        }\r\n      });\r\n    }\r\n  });\r\n\r\n  return (\r\n    <Container>\r\n      <label\r\n        style = {\r\n            {color:\"white\",\r\n            font:\"Arial\",\r\n            textAlign: \"center\",\r\n            verticalAlign : \"center\",\r\n            paddingTop : \"10\"\r\n        }    \r\n        }\r\n      >\r\n        {\" \"}\r\n        <br />\r\n        {userInfo\r\n          ? \" Investment Simulator - \" + userInfo.name\r\n          : \" Investment Simulator\"}{\" \"}\r\n      </label>\r\n    </Container>\r\n  );\r\n}\r\n","export type Asset = {\r\n  stock: Stock;\r\n  lots: Lot[];\r\n}\r\n\r\nexport type Stock = {\r\n  name: string;\r\n  symbol: string;\r\n  price: SpotPrice;\r\n}\r\n\r\nexport type SpotPrice = {\r\n  bid: number;\r\n  ask: number;\r\n  previousClose: number;\r\n};\r\nexport type HistoricalPrice = { date: Date; price: number };\r\n\r\nexport type HistoricalData = {prices:HistoricalPrice[], dividends:Dividend[], splits:Split[]}\r\n\r\nexport type Dividend = {\r\n    date: Date; amount: number\r\n}\r\n\r\nexport type Split = {\r\n  date:Date, from:number, to:number\r\n}\r\n\r\nexport type UserInfo = {\r\n  name: string;\r\n  email: string;\r\n  cash: number;\r\n  created: Date;\r\n}\r\nexport type Account = {\r\n  info:UserInfo;\r\n  transactions: Transaction[];\r\n  assets: Asset[];\r\n};\r\n\r\nexport type Lot = { shares: number; basis: number };\r\nexport type Transaction = {\r\n  date: Date;\r\n  type: TransactionType;\r\n  amount: number;\r\n  symbol: string;\r\n  shares: number;\r\n  name:string;\r\n  cash:number;\r\n  commission:number;\r\n  from:number,\r\n  to:number\r\n};\r\n\r\nexport enum TransactionType {\r\n  GIFT = \"GIFT\",\r\n  BUY=\"BUY\",\r\n  SELL=\"SELL\",\r\n  DIVIDEND=\"DIVIDEND\",\r\n  SPLIT=\"SPLIT\"\r\n}\r\n\r\nexport const COMMISSION: number = 15.0;\r\nexport const INITIAL_GIFT: number = 1000000;\r\n","import { format, isValid } from \"date-fns\";\r\nimport { getHistoricalPrices } from \"./APIService\";\r\nimport {\r\n  Asset,\r\n  INITIAL_GIFT,\r\n  Transaction,\r\n  TransactionType,\r\n  Account,\r\n  HistoricalPrice,\r\n} from \"./types\";\r\n\r\ntype Position = {\r\n  symbol: string;\r\n  shares: number;\r\n};\r\n\r\nexport type StockValue = {\r\n  symbol:string;\r\n  value:number;\r\n}\r\n\r\ntype PortfolioSnapshot = {\r\n  date: Date;\r\n  positions: Position[];\r\n  cash: number;\r\n};\r\n\r\nexport type PortfolioValue = {\r\n  date: Date;\r\n  stocks: StockValue[];\r\n  cash: number;\r\n  total: number;\r\n};\r\n\r\nexport const getCostBasis = (asset: Asset): number => {\r\n  var costBasis: number = 0;\r\n  for (var lot of asset.lots) {\r\n    //console.log(lot);\r\n    costBasis += lot.basis * lot.shares;\r\n  }\r\n  return costBasis;\r\n};\r\n\r\nexport const getQuantity = (asset: Asset): number => {\r\n  var quantity: number = 0;\r\n  for (var lot of asset.lots) {\r\n    quantity += lot.shares;\r\n  }\r\n  return quantity;\r\n};\r\n\r\nexport const getAssetValue = (asset: Asset): number => {\r\n  return (\r\n    getQuantity(asset) *\r\n    (asset.stock.price.bid || asset.stock.price.previousClose || 0)\r\n  );\r\n};\r\n\r\nexport const getGain = (user: Account): number => {\r\n  return getAccountValue(user) - INITIAL_GIFT;\r\n};\r\n\r\nexport const getAccountValue = (user: Account): number => {\r\n  var total: number = 0;\r\n  for (var asset of user.assets) {\r\n    total += getAssetValue(asset);\r\n  }\r\n  return total + user.info.cash;\r\n};\r\n\r\nexport const getPercentOfAccount = (user: Account, asset: Asset): number => {\r\n  return getAssetValue(asset) / getAccountValue(user);\r\n};\r\n\r\nexport const getGainLoss = (asset: Asset): number => {\r\n  return getAssetValue(asset) - getCostBasis(asset);\r\n};\r\n\r\nexport const getCash = (user: Account): number => {\r\n  return user.info.cash;\r\n};\r\n\r\nexport const formatCurrency = (money: number): string => {\r\n  return (\r\n    \"$\" +\r\n    new Intl.NumberFormat(\"en-us\", {\r\n      minimumFractionDigits: 2,\r\n      maximumFractionDigits: 2,\r\n    }).format(money)\r\n  );\r\n};\r\n\r\nexport const formateDate = (date: Date): string => {\r\n  return new Intl.DateTimeFormat(\"en-us\", {\r\n    dateStyle: \"full\",\r\n  }).format(date);\r\n};\r\n\r\nexport const formatPercent = (percent: number): string => {\r\n  return (\r\n    new Intl.NumberFormat(\"en-us\", {\r\n      minimumFractionDigits: 2,\r\n      maximumFractionDigits: 2,\r\n    }).format(100 * percent) + \"%\"\r\n  );\r\n};\r\n\r\nexport const formatDate = (date: Date, long: boolean): string => {\r\n  var dateToFormat: Date = new Date(date);\r\n  if (!isValid(dateToFormat)) return \"\";\r\n  const formatStr = long ? \"MMMM dd, yyyy\" : \"yyyy-MM-dd\";\r\n\r\n  return format(dateToFormat, formatStr);\r\n};\r\n\r\nfunction getTransactionsOnDate(\r\n  transactions: Transaction[],\r\n  date: Date\r\n): Transaction[] {\r\n  let dateTransactions: Transaction[] = [];\r\n  date.setHours(0, 0, 0, 0);\r\n  for (let transaction of transactions) {\r\n    let transactionDate: Date = new Date(transaction.date);\r\n    transactionDate.setHours(0, 0, 0, 0);\r\n    if (transactionDate > date) break;\r\n    if (transactionDate.getTime() === date.getTime())\r\n      dateTransactions.push(transaction);\r\n  }\r\n  return dateTransactions;\r\n}\r\n\r\nfunction adjustForSplits(\r\n  buyOrSell: Transaction,\r\n  transactions: Transaction[]\r\n): number {\r\n  let shares: number = buyOrSell.shares;\r\n  for (let transaction of transactions) {\r\n    if (\r\n      transaction.type == TransactionType.SPLIT &&\r\n      transaction.symbol.toUpperCase() == buyOrSell.symbol.toUpperCase()\r\n    ) {\r\n      if (transaction.date > buyOrSell.date) {\r\n        shares = shares * (transaction.to / transaction.from);\r\n      }\r\n    }\r\n  }\r\n  return shares;\r\n}\r\n\r\nasync function getPortfolioSnapshots(\r\n  transactions: Transaction[]\r\n): Promise<PortfolioSnapshot[]> {\r\n  const tickerMap = new Map<string, number>();\r\n\r\n  let snapshots: PortfolioSnapshot[] = [];\r\n  let cash: number = 0;\r\n  const startDate: Date = new Date(transactions[0].date);\r\n  const endDate: Date = new Date(Date.now());\r\n  endDate.setDate(endDate.getDate() - 2);\r\n\r\n  for (\r\n    let date: Date = startDate;\r\n    date < endDate;\r\n    date.setDate(date.getDate() + 1)\r\n  ) {\r\n    const dateTransactions: Transaction[] = getTransactionsOnDate(\r\n      transactions,\r\n      date\r\n    );\r\n\r\n    for (let transaction of dateTransactions) {\r\n      switch (transaction.type) {\r\n        case TransactionType.BUY: {\r\n          let shares: number | undefined = tickerMap.get(transaction.symbol);\r\n          const adjustedShares = adjustForSplits(transaction, transactions);\r\n          if (shares !== undefined) shares += adjustedShares;\r\n          else shares = adjustedShares;\r\n          tickerMap.set(transaction.symbol, shares);\r\n          cash -= transaction.amount;\r\n          break;\r\n        }\r\n        case TransactionType.DIVIDEND: {\r\n          cash += transaction.amount;\r\n          break;\r\n        }\r\n        case TransactionType.SELL: {\r\n          let shares: number | undefined = tickerMap.get(transaction.symbol);\r\n          const adjustedShares = adjustForSplits(transaction, transactions);\r\n          if (shares !== undefined) shares -= adjustedShares;\r\n          else {\r\n            console.log(\"******** Error - sold shares that were not owned\");\r\n            shares = 0;\r\n          }\r\n          tickerMap.set(transaction.symbol, shares);\r\n          cash += transaction.amount;\r\n          break;\r\n        }\r\n        case TransactionType.GIFT: {\r\n          cash += transaction.amount;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    //console.log(\"ticker map is \", tickerMap);\r\n    let positions: Position[] = [];\r\n\r\n    tickerMap.forEach((shares: number, tickerSymbol: string) => {\r\n      if (shares !== undefined && shares > 0) {\r\n        positions.push({ shares: shares, symbol: tickerSymbol });\r\n      }\r\n    });\r\n\r\n    snapshots.push({ cash: cash, date: new Date(date), positions: positions });\r\n  }\r\n\r\n  return snapshots;\r\n}\r\n\r\nconst priceMap: Map<string, HistoricalPrice[]> = new Map();\r\n\r\nconst getPriceHistory = async (\r\n  symbol: string,\r\n  startDate: Date\r\n): Promise<HistoricalPrice[]> => {\r\n  let prices: HistoricalPrice[] | undefined = priceMap.get(symbol);\r\n  if (prices) return prices;\r\n\r\n  prices = await getHistoricalPrices(symbol, startDate);\r\n  priceMap.set(symbol, prices);\r\n  return prices;\r\n};\r\n\r\nconst getStockPriceOnDateLocal = async (\r\n  symbol: string,\r\n  date: Date\r\n): Promise<number> => {\r\n  const history: HistoricalPrice[] = await getPriceHistory(symbol, date);\r\n\r\n  // start from the beginning?\r\n  const startDiff: number | undefined =\r\n    history.length > 2\r\n      ? Math.abs(new Date(history[0].date).getTime() - new Date(date).getTime())\r\n      : undefined;\r\n  const endDiff: number | undefined =\r\n    history.length > 2\r\n      ? Math.abs(new Date(history[history.length - 1].date).getTime() - new Date(date).getTime())\r\n      : undefined;\r\n\r\n  // closer to the end\r\n  if (startDiff && endDiff && startDiff > endDiff) {\r\n\r\n    for (let i = history.length-1; i >=0; --i) {\r\n      const data:HistoricalPrice = history[i] \r\n      const historicalDate: Date = new Date(data.date);\r\n      if (historicalDate <= date) {\r\n        //console.log(symbol, \"(Reverse) price of \", symbol, \" on \", date, \": \", data.price)\r\n        return data.price;\r\n      }\r\n    }\r\n  }\r\n  // start from the beginning\r\n  else {\r\n    for (let data of history) {\r\n      const historicalDate: Date = new Date(data.date);\r\n      if (historicalDate >= date) {\r\n        //console.log(symbol, \"(Forward) price of \", symbol, \" on \", date, \": \", data.price)\r\n        return data.price;\r\n      }\r\n    }\r\n  }\r\n  console.log(symbol, \"price on \", date, \": \", 0);\r\n  return 0;\r\n};\r\n\r\n\r\n// type StockValue = {\r\n//   symbol:string;\r\n//   value:number;\r\n// }\r\n\r\n// type PortfolioSnapshot = {\r\n//   date: Date;\r\n//   positions: Position[];\r\n//   cash: number;\r\n// };\r\n\r\n// export type PortfolioValue = {\r\n//   date: Date;\r\n//   values: StockValue[];\r\n// };\r\nexport const getHistoricalValues = async (\r\n  transactions: Transaction[]\r\n): Promise<PortfolioValue[]> => {\r\n  const values: PortfolioValue[] = [];\r\n\r\n  const snapshots: PortfolioSnapshot[] = await getPortfolioSnapshots(\r\n    transactions\r\n  );\r\n\r\n  for (let snapshot of snapshots) {\r\n    let total: number = 0;\r\n    const snapshotDate: Date = new Date(snapshot.date);\r\n    //var debugMsg:string = \"Date: \" + snapshotDate + \": \"\r\n\r\n    const stockValues:StockValue[] = []\r\n    for (let position of snapshot.positions) {\r\n      const price: number = await getStockPriceOnDateLocal(\r\n        position.symbol,\r\n        snapshotDate\r\n      );\r\n      //debugMsg += (\"-- \" + position.shares + \" of \" + position.symbol + \" at \" + price)\r\n      const stockValue:StockValue = {symbol: position.symbol, value:position.shares * price}\r\n      stockValues.push(stockValue)\r\n      total += stockValue.value;\r\n    }\r\n    //debugMsg += (\"-- cash: \" + snapshot.cash)\r\n    total += snapshot.cash;\r\n\r\n    //console.log(debugMsg)\r\n    values.push({ date: snapshotDate, cash:snapshot.cash, total:total, stocks: stockValues });\r\n  }\r\n\r\n  priceMap.clear();\r\n\r\n  return values;\r\n};\r\n\r\nexport const calcSharePrice = (transaction: Transaction): number => {\r\n  if (transaction.type == TransactionType.BUY) {\r\n    return (transaction.amount - transaction.commission) / transaction.shares;\r\n  } else {\r\n    const perShare: number =\r\n      (transaction.amount + transaction.commission) / transaction.shares;\r\n    return perShare;\r\n  }\r\n};\r\n","import { useEffect, useState } from \"react\";\r\nimport { getStockPriceOnDate, getTransactions } from \"../APIService\";\r\nimport {\r\n  formatDate,\r\n  getHistoricalValues,\r\n  PortfolioValue,\r\n  StockValue,\r\n} from \"../Calculations\";\r\n//import { Line, LineConfig } from \"@ant-design/plots\";\r\nimport { Empty, Spin } from \"antd\";\r\nimport { Line } from \"react-chartjs-2\";\r\nimport { Chart, registerables } from \"chart.js\";\r\n\r\nChart.register(...registerables);\r\n\r\nconst lineColors:string[] = [\"cadetblue\", \"darkorchid\", \"cornflowerblue\", \"indigo\", \"olive\", \"darkseagreen\", \"darkmagenta\"]\r\n\r\nconst POINT_RADIUS = 3.0\r\nconst POINT_HOVER_RADIUS = 6.0\r\n\r\ntype LineData = {\r\n  id: number;\r\n  label: string;\r\n  data: number[];\r\n  pointRadius: string;\r\n  pointHoverRadius:number,\r\n  backgroundColor: string;\r\n};\r\n\r\ntype ChartData = { labels: string[]; datasets: LineData[] };\r\n\r\nfunction Analysis() {\r\n  const [chartData, setChartData] = useState<ChartData | undefined>(undefined);\r\n\r\n  useEffect(() => {\r\n    getTransactions().then((transactions) => {\r\n      getHistoricalValues(transactions).then((historicalValues) => {\r\n        const chartData = createChartData(historicalValues);\r\n        setChartData(chartData);\r\n      });\r\n    });\r\n  }, []);\r\n\r\n  const MAX_POINTS:number = 100\r\n\r\n  const thinPortfolioValues = (originalValues:PortfolioValue[]):PortfolioValue[] => {\r\n\r\n    if (originalValues.length < MAX_POINTS) {\r\n      return originalValues\r\n    }\r\n\r\n    const thinnedValues:PortfolioValue[] = []\r\n    const interval:number = originalValues.length/MAX_POINTS\r\n\r\n    for (let i:number=0; i < originalValues.length; i += interval) {\r\n      const dateIdx = Math.floor(i)\r\n      thinnedValues.push(originalValues[dateIdx])\r\n    }\r\n    if (thinnedValues[thinnedValues.length-1] != originalValues[originalValues.length-1]) {\r\n      thinnedValues.push(originalValues[originalValues.length-1])\r\n    }\r\n\r\n    return thinnedValues\r\n  }\r\n\r\n  const createChartData = (portfolioValues: PortfolioValue[]): ChartData => {\r\n    const labels: string[] = [];\r\n    const datasets: any[] = [];\r\n    const totalValues: number[] = [];\r\n    const cashValues: number[] = [];\r\n\r\n    portfolioValues = thinPortfolioValues(portfolioValues)\r\n\r\n    const stockValueMap: Map<string, number[]> = new Map();\r\n    for (let value of portfolioValues) {\r\n      for (let stockValue of value.stocks) {\r\n        const stockValues: number[] | undefined = stockValueMap.get(\r\n          stockValue.symbol\r\n        );\r\n        if (!stockValues) {\r\n          stockValueMap.set(stockValue.symbol, []);\r\n        }\r\n      }\r\n    }\r\n\r\n    for (let portfolioValue of portfolioValues) {\r\n      labels.push(formatDate(portfolioValue.date, false));\r\n      totalValues.push(portfolioValue.total);\r\n      cashValues.push(portfolioValue.cash);\r\n\r\n      stockValueMap.forEach((stockValues: number[], key: string) => {\r\n        let stockValue: number = NaN;\r\n        for (let stock of portfolioValue.stocks) {\r\n          if (stock.symbol.toUpperCase() === key.toUpperCase()) {\r\n            stockValue = stock.value;\r\n            break;\r\n          }\r\n        }\r\n        stockValues.push(stockValue);\r\n      });\r\n    }\r\n\r\n    datasets.push({\r\n      id: 1,\r\n      label: \"Total\",\r\n      data: totalValues,\r\n      pointRadius: POINT_RADIUS,\r\n      pointHoverRadius:POINT_HOVER_RADIUS,\r\n      borderColor: \"blue\"\r\n    });\r\n\r\n    datasets.push({\r\n      id: 2,\r\n      label: \"Cash\",\r\n      data: cashValues,\r\n      pointRadius: POINT_RADIUS,\r\n      pointHoverRadius:POINT_HOVER_RADIUS,\r\n      borderColor: \"green\",\r\n    });\r\n\r\n    let id: number = 3;\r\n\r\n\r\n    let colorId:number = 0;\r\n    stockValueMap.forEach((stockValues: number[], key: string) => {\r\n      const colorName:string = lineColors[colorId] \r\n      if (++colorId == lineColors.length)\r\n        colorId =0;\r\n      datasets.push({\r\n        id: id++,\r\n        label: key,\r\n        //@ts-ignore\r\n        data: stockValues,\r\n        pointRadius: POINT_RADIUS,\r\n        pointHoverRadius: POINT_HOVER_RADIUS,\r\n        borderColor: colorName,\r\n      });\r\n    });\r\n\r\n    const chartData: ChartData = {\r\n      labels,\r\n      datasets,\r\n    };\r\n    return chartData;\r\n  };\r\n\r\n  return (\r\n    <div className=\"Analysis\">\r\n      <header className=\"Analysis-header\">\r\n        {chartData === undefined ? (\r\n          <div>\r\n            <Spin size=\"default\" />\r\n          </div>\r\n        ) : chartData.labels.length < 7 ? (\r\n          <Empty description=\"History unavailable for accounts created within the last week\"></Empty>\r\n        ) : (\r\n          //@ts-ignore\r\n          <Line datasetIdKey=\"1\" data={chartData} />\r\n        )}\r\n      </header>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Analysis;\r\n","import { Form, Spin } from \"antd\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { getAccount, getUserInfo } from \"../APIService\";\r\nimport {\r\n  formatCurrency,\r\n  formatDate,\r\n  getAccountValue,\r\n  getGain,\r\n} from \"../Calculations\";\r\nimport { Account, UserInfo } from \"../types\";\r\nimport \"antd/dist/antd.css\";\r\n\r\nfunction Overview() {\r\n  const [account, setAccount] = useState<Account>();\r\n  const [userInfo, setUserInfo] = useState<UserInfo>();\r\n  const [loadingAccount, setLoadingUser] = useState<boolean>(false);\r\n  const [loadingUserInfo, setLoadingAccount] = useState<boolean>(false);\r\n\r\n  useEffect(() => {\r\n    setLoadingAccount(true);\r\n    getUserInfo().then((foundUserInfo) => {\r\n      foundUserInfo && setUserInfo(foundUserInfo);\r\n      setLoadingAccount(false);\r\n      setLoadingUser(true);\r\n      getAccount().then((foundUser) => {\r\n        foundUser && setAccount(foundUser);\r\n        setLoadingUser(false);\r\n      });\r\n    });\r\n  }, []);\r\n\r\n  const getAccountValueString = (account: Account): string => {\r\n    return formatCurrency(getAccountValue(account));\r\n  };\r\n\r\n  const getGainString = (account: Account): string => {\r\n    return formatCurrency(getGain(account));\r\n  };\r\n\r\n  const formItemLayout = {\r\n    labelCol: {\r\n      span: 2,\r\n      offset: 0,\r\n    },\r\n    wrapperCol: {\r\n      span: 36,\r\n      offset: 1,\r\n    },\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <br />\r\n      <Form name=\"overview\" {...formItemLayout}>\r\n        <Form.Item label=\"Name\" labelAlign=\"right\">\r\n          {loadingUserInfo || !userInfo ? (\r\n            <Spin size=\"small\" />\r\n          ) : (\r\n            <label>{userInfo.name}</label>\r\n          )}\r\n        </Form.Item>\r\n\r\n        <Form.Item label=\"User ID\" labelAlign=\"right\">\r\n          <span className=\"ant-form-text\">\r\n            {userInfo && !loadingUserInfo && userInfo.email ? (\r\n              userInfo.email\r\n            ) : (\r\n              <Spin size=\"small\" />\r\n            )}\r\n          </span>\r\n        </Form.Item>\r\n\r\n        <Form.Item label=\"Account Created\" labelAlign=\"right\">\r\n          <span className=\"ant-form-text\">\r\n            {userInfo && !loadingUserInfo ? (\r\n              formatDate(userInfo.created, true)\r\n            ) : (\r\n              <Spin size=\"small\" />\r\n            )}\r\n          </span>\r\n        </Form.Item>\r\n\r\n        <Form.Item label=\"Account Value\" labelAlign=\"right\">\r\n          <span className=\"ant-form-text\">\r\n            {!account || loadingAccount ? (\r\n              <Spin size=\"small\" />\r\n            ) : (\r\n              getAccountValueString(account)\r\n            )}\r\n          </span>\r\n        </Form.Item>\r\n\r\n        <Form.Item label=\"Cash Balance\" labelAlign=\"right\">\r\n          <span className=\"ant-form-text\">\r\n            {userInfo && !loadingUserInfo ? (\r\n              formatCurrency(userInfo.cash)\r\n            ) : (\r\n              <Spin size=\"small\" />\r\n            )}\r\n          </span>\r\n        </Form.Item>\r\n\r\n        <Form.Item label=\"Total Gain/Loss\" labelAlign=\"right\">\r\n          <span className=\"ant-form-text\">\r\n            {loadingAccount || !account ? (\r\n              <Spin size=\"small\" />\r\n            ) : (\r\n              <label\r\n                style={\r\n                  getGain(account) < 0 ? { color: \"red\" } : { color: undefined }\r\n                }\r\n              >\r\n                {getGainString(account)}\r\n              </label>\r\n            )}\r\n          </span>\r\n        </Form.Item>\r\n      </Form>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Overview;\r\n","import { useEffect, useState } from \"react\";\r\nimport { getAccount } from \"../APIService\";\r\nimport { Account } from \"../types\";\r\nimport { Spin, Table, TablePaginationConfig } from \"antd\";\r\nimport {\r\n  formatCurrency,\r\n  formatPercent,\r\n  getAccountValue,\r\n  getAssetValue,\r\n  getCostBasis,\r\n  getGainLoss,\r\n  getPercentOfAccount,\r\n  getQuantity,\r\n} from \"../Calculations\";\r\n\r\ntype PositionRow = {\r\n  name: string;\r\n  symbol: string;\r\n  bid: string;\r\n  ask: string;\r\n  quantity: string;\r\n  costBasis: string;\r\n  currentValue: string;\r\n  percentOfAccount: string;\r\n  gain: string;\r\n};\r\n\r\nfunction Positions() {\r\n  const [data, setData] = useState<PositionRow[] | undefined>();\r\n\r\n  useEffect(() => {\r\n    getAccount().then((foundUser) => {\r\n      if (foundUser) {\r\n        setData(calcData(foundUser));\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  const calcData = (user: Account): PositionRow[] => {\r\n    const data: PositionRow[] = [];\r\n    var totalBasis: number = 0;\r\n    var totalGain: number = 0;\r\n    for (var asset of user.assets) {\r\n      //console.log(\"pushing asset = \", JSON.stringify(asset))\r\n      totalGain += getGainLoss(asset);\r\n      totalBasis += getCostBasis(asset);\r\n      data.push({\r\n        name: asset.stock.name,\r\n        symbol: asset.stock.symbol,\r\n        // lastPrice: formatCurrency(\r\n        //   asset.stock.price.bid || asset.stock.price.previousClose\r\n        // ),\r\n        bid: formatCurrency(\r\n          asset.stock.price.bid || asset.stock.price.previousClose\r\n        ),\r\n        ask: formatCurrency(\r\n          asset.stock.price.ask || asset.stock.price.previousClose\r\n        ),\r\n        quantity: getQuantity(asset).toString(),\r\n        costBasis: formatCurrency(getCostBasis(asset)),\r\n        currentValue: formatCurrency(getAssetValue(asset)),\r\n        percentOfAccount: formatPercent(getPercentOfAccount(user, asset)),\r\n        gain: formatCurrency(getGainLoss(asset)),\r\n      });\r\n    }\r\n    //@ts-ignore\r\n    data.push({\r\n      name: \"Cash\",\r\n      currentValue: formatCurrency(user.info.cash),\r\n      costBasis: formatCurrency(user.info.cash),\r\n      percentOfAccount: formatPercent(user.info.cash / getAccountValue(user)),\r\n    });\r\n\r\n    return data;\r\n  };\r\n\r\n  const columns: object[] = [\r\n    { title: \"Symbol\", dataIndex: \"symbol\", key: \"symbol\" },\r\n    { title: \"Asset\", dataIndex: \"name\", key: \"name\" },\r\n    { title: \"Quantity\", dataIndex: \"quantity\", key: \"quantity\" },\r\n    { title: \"Bid\", dataIndex: \"bid\", key: \"bid\" },\r\n    { title: \"Ask\", dataIndex: \"ask\", key: \"ask\" },\r\n    {\r\n      title: \"Current Value\",\r\n      dataIndex: \"currentValue\",\r\n      key: \"currentValue\",\r\n    },\r\n    { title: \"Cost Basis\", dataIndex: \"costBasis\", key: \"costBasis\" },\r\n\r\n    {\r\n      title: \"Percentage of Account\",\r\n      dataIndex: \"percentOfAccount\",\r\n      key: \"percentOfAccount\",\r\n    },\r\n    { title: \"Total Gain/Loss\", dataIndex: \"gain\", key: \"gain\" },\r\n  ];\r\n\r\n\r\n  const tablePaginationConfig:TablePaginationConfig = {\r\n    pageSize : 100\r\n  }\r\n  \r\n  return (\r\n    <div className=\"Positions\">\r\n      <header className=\"Overview-header\">\r\n        {data === undefined ? (\r\n          <div>\r\n            <Spin size=\"default\" />\r\n          </div>\r\n        ) : (\r\n          <Table dataSource={data} columns={columns} pagination={tablePaginationConfig}/>\r\n        )}\r\n      </header>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Positions;\r\n","import { Divider, Form, Select } from \"antd\";\r\nimport { useState } from \"react\";\r\nimport Buy from \"../components/Buy\";\r\nimport Sell from \"../components/Sell\";\r\n\r\nenum TradeType {\r\n  BUY = \"BUY\",\r\n  SELL = \"SELL\",\r\n}\r\n\r\nfunction Trade() {\r\n  const [tradeType, setTradeType] = useState(TradeType.BUY);\r\n\r\n  const handleTradeType = (value: TradeType) => {\r\n    setTradeType(value)\r\n  };\r\n\r\n  const formItemLayout = {\r\n    labelCol: {\r\n      span: 2,\r\n      offset: 0\r\n    },\r\n    wrapperCol: {\r\n      span: 2,\r\n    },\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <br />\r\n      <Form name=\"trade\" {...formItemLayout}>\r\n        <Form.Item label=\"Trade Type\" labelAlign=\"left\">\r\n          <Select onChange={handleTradeType} defaultValue={TradeType.BUY} >\r\n            <Select.Option value={TradeType.BUY}>{TradeType.BUY}</Select.Option>\r\n            <Select.Option value={TradeType.SELL}>{TradeType.SELL}</Select.Option>\r\n          </Select>\r\n        </Form.Item>\r\n      </Form>\r\n      <Divider orientation=\"left\" orientationMargin=\"0\">\r\n      {tradeType == TradeType.BUY? \"Buy Stock\" : \"Sell Stock\"}\r\n    </Divider>\r\n      {tradeType == TradeType.BUY ? <Buy /> : <Sell />}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Trade;\r\n","import { Button, Form, Input, Spin } from \"antd\";\r\nimport { ChangeEvent, useEffect, useState, useRef } from \"react\";\r\nimport {\r\n  buyAsset,\r\n  BuyAssetResponse,\r\n  getCash,\r\n  getStockPrice,\r\n  lookupTicker,\r\n} from \"../APIService\";\r\nimport { formatCurrency, getAccountValue } from \"../Calculations\";\r\nimport { COMMISSION } from \"../types\";\r\n\r\nconst PLEASE_ENTER_VALID_STOCK: string =\r\n  \"Please enter a valid stock ticker symbol\";\r\n\r\nexport default function Buy() {\r\n  const [typedSymbol, setTypedSymbol] = useState(\"\");\r\n  const [sharesToBuy, setSharesToBuy] = useState<number>(0);\r\n  const [askPrice, setAskPrice] = useState<number | null>(0);\r\n  const [totalCost, setTotalCost] = useState<number>(0);\r\n  const [shareCost, setShareCost] = useState<number>(0);\r\n  const [companyName, setCompanyName] = useState<string | null>(null);\r\n  const [cash, setCash] = useState<number>(0);\r\n  //const [loading, setLoading] = useState<boolean>(false);\r\n\r\n  const currentTypedSymbol = useRef<string>(\"\");\r\n  const [loadingStock, setLoadingStock] = useState<boolean>(false);\r\n  const [loadingPrice, setLoadingPrice] = useState<boolean>(false);\r\n\r\n  const handleTickerSymbol = (e: ChangeEvent<HTMLInputElement>) => {\r\n    setTypedSymbol(e.target.value);\r\n  };\r\n\r\n  const handleSharesToBuy = (e: ChangeEvent<HTMLInputElement>) => {\r\n    const typedValue: string = e.target.value;\r\n    const shares: number = Number.parseInt(typedValue);\r\n    if (shares) setSharesToBuy(shares);\r\n    else setSharesToBuy(0);\r\n  };\r\n\r\n  useEffect(() => {\r\n    getCash().then((userCash: number) => {\r\n      setCash(userCash);\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setLoadingStock(true);\r\n    currentTypedSymbol.current = typedSymbol;\r\n    lookupTicker(typedSymbol)\r\n      .then((foundCompanyName: string | null) => {\r\n        if (typedSymbol === currentTypedSymbol.current) {\r\n          setLoadingStock(false);\r\n          setCompanyName(foundCompanyName);\r\n          if (foundCompanyName) {\r\n            setLoadingPrice(true);\r\n            getStockPrice(typedSymbol)\r\n              .then((foundPrice) => {\r\n                setLoadingPrice(false);\r\n                setAskPrice(foundPrice.ask);\r\n              })\r\n              .catch((ex: Error) => {\r\n                setLoadingPrice(false);\r\n              });\r\n          } else {\r\n            setAskPrice(null);\r\n          }\r\n          setLoadingStock(false);\r\n        }\r\n      })\r\n      .catch((ex: Error) => {\r\n        setLoadingStock(false);\r\n      });\r\n  }, [typedSymbol]);\r\n\r\n  useEffect(() => {\r\n    if (companyName != null && askPrice != null) {\r\n      const shareOnlyCost: number = sharesToBuy * askPrice;\r\n      setShareCost(shareOnlyCost);\r\n      setTotalCost(\r\n        shareOnlyCost > 0 ? shareOnlyCost + COMMISSION : shareOnlyCost\r\n      );\r\n    } else {\r\n      setShareCost(0);\r\n      setTotalCost(0);\r\n    }\r\n  }, [companyName, askPrice, sharesToBuy]);\r\n\r\n  const getForegroundColor = (): string => {\r\n    return !companyName ? \"red\" : \"black\";\r\n  };\r\n\r\n  const getCompanyText = (): string => {\r\n    const text: string = !companyName ? PLEASE_ENTER_VALID_STOCK : companyName;\r\n    //console.log(\"returning company text = \", {text});\r\n    return text;\r\n  };\r\n\r\n  const handlePurchase = async () => {\r\n    if (cash < totalCost) {\r\n      window.alert(\"You don't have enough cash for  that purchase \");\r\n      return;\r\n    }\r\n    if (companyName) {\r\n      const msg: string =\r\n        \"Please confirm purchase of \" +\r\n        sharesToBuy +\r\n        \" shares of \" +\r\n        companyName +\r\n        \" for a total of \" +\r\n        formatCurrency(totalCost) +\r\n        \".\";\r\n      const isOK: boolean = window.confirm(msg);\r\n      if (isOK) {\r\n        buyAsset(typedSymbol, sharesToBuy, askPrice || 0).then(\r\n          (buyAssetResponse: BuyAssetResponse) => {\r\n            const { successful, remainingCash } = buyAssetResponse;\r\n            if (successful) {\r\n              window.alert(\r\n                \"Purchase successful. New cash balance is \" +\r\n                  formatCurrency(remainingCash)\r\n              );\r\n              window.location.assign(\"/transactions\");\r\n              // console.log(\"showing historical prices *****************************************************\")\r\n            }\r\n          },\r\n          () => {\r\n            window.alert(\r\n              \"Purchase was not executed due to critical server error\"\r\n            );\r\n          }\r\n        );\r\n      }\r\n    } else {\r\n      window.alert(\"Purchase cancelled\");\r\n    }\r\n  };\r\n  const formItemLayout = {\r\n    labelCol: {\r\n      span: 2,\r\n      offset: 0,\r\n    },\r\n    wrapperCol: {\r\n      span: 6,\r\n      offset: 1,\r\n    },\r\n  };\r\n\r\n  const tailLayout = {\r\n    wrapperCol: {\r\n      offset: 3,\r\n      span: 16,\r\n    },\r\n  };\r\n  return (\r\n    <Form name=\"buy\" {...formItemLayout}>\r\n      <Form.Item label=\"Stock\">\r\n        <Input\r\n          placeholder=\"Enter stock ticker symbol\"\r\n          onChange={handleTickerSymbol}\r\n        ></Input>\r\n        <>\r\n          {loadingStock ? (\r\n            <Spin size=\"small\" />\r\n          ) : (\r\n            <label\r\n              style={\r\n                !!typedSymbol && !!companyName\r\n                  ? { color: undefined }\r\n                  : { color: \"red\" }\r\n              }\r\n            >\r\n              {!typedSymbol\r\n                ? \"\"\r\n                : companyName\r\n                ? companyName\r\n                : \"Invalid ticker symbol\"}\r\n            </label>\r\n          )}{\" \"}\r\n        </>\r\n      </Form.Item>\r\n\r\n      <Form.Item label=\"Current Ask Price\">\r\n        {loadingPrice || loadingStock ? (\r\n          <Spin size=\"small\" />\r\n        ) : (\r\n          <label>{askPrice ? formatCurrency(askPrice) : \"Please enter a valid ticker symbol\"}</label>\r\n        )}\r\n      </Form.Item>\r\n\r\n      <Form.Item label=\"Shares to Buy\">\r\n        <Input\r\n          placeholder={\"Enter number of shares to buy\"}\r\n          onChange={handleSharesToBuy}\r\n          value={sharesToBuy == 0 ? undefined : sharesToBuy}\r\n        ></Input>\r\n      </Form.Item>\r\n\r\n      <Form.Item label=\"Commission\">\r\n        <label>{formatCurrency(COMMISSION)}</label>\r\n      </Form.Item>\r\n\r\n      <Form.Item label=\"Total Cost\">\r\n        {sharesToBuy > 0 && (loadingStock || loadingPrice) ? (\r\n          <Spin size=\"small\" />\r\n        ) : (\r\n          <label\r\n            style={totalCost > cash ? { color: \"red\" } : { color: undefined }}\r\n          >\r\n            {sharesToBuy > 0\r\n              ? formatCurrency(totalCost)\r\n              : \"Please enter the number of shares to buy\"}\r\n          </label>\r\n        )}\r\n      </Form.Item>\r\n\r\n      <Form.Item {...tailLayout}>\r\n        <Button\r\n          type=\"primary\"\r\n          onClick={handlePurchase}\r\n          disabled={\r\n            sharesToBuy == 0 ||\r\n            loadingPrice ||\r\n            loadingStock ||\r\n            !companyName ||\r\n            totalCost > cash\r\n          }\r\n        >\r\n          Submit\r\n        </Button>\r\n      </Form.Item>\r\n    </Form>\r\n  );\r\n}\r\n","import { Button, Empty, Form, Input, Select, Spin } from \"antd\";\r\nimport { ChangeEvent, useEffect, useState } from \"react\";\r\nimport {\r\n  getAssets,\r\n  getShareCount,\r\n  getStockPrice,\r\n  sellAsset,\r\n} from \"../APIService\";\r\nimport { formatCurrency } from \"../Calculations\";\r\nimport { Asset, COMMISSION, SpotPrice } from \"../types\";\r\n\r\nexport default function Sell() {\r\n  const [assets, setAssets] = useState<Asset[] | undefined>(undefined);\r\n  const [loadingAssets, setLoadingAssets] = useState<boolean>(false);\r\n  const [asset, setAsset] = useState<Asset | undefined>(undefined);\r\n  const [sharesToSell, setSharesToSell] = useState(0);\r\n  const [price, setPrice] = useState<SpotPrice>({\r\n    bid: 0,\r\n    ask: 0,\r\n    previousClose: 0,\r\n  });\r\n\r\n  const [loadingPrice, setLoadingPrice] = useState<boolean>(false);\r\n\r\n  const handleAssetChange = (value: string) => {\r\n    if (assets && value) {\r\n      const foundAsset: Asset | undefined = assets.find(\r\n        (currAsset) =>\r\n          currAsset.stock.symbol.toUpperCase() === value.toUpperCase()\r\n      );\r\n      if (foundAsset) {\r\n        setAsset(foundAsset);\r\n        setSharesToSell(0);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleSharesToSell = (e: ChangeEvent<HTMLInputElement>) => {\r\n    const typedValue: string = e.target.value;\r\n    const shares: number = Number.parseInt(typedValue);\r\n    if (shares) setSharesToSell(shares);\r\n    else setSharesToSell(0);\r\n  };\r\n\r\n  const handleSale = async () => {\r\n    if (sharesToSell > getShareCount(asset)) {\r\n      window.alert(\"Insufficient shares for this sale\");\r\n      return;\r\n    }\r\n\r\n    if (asset) {\r\n      const totalCost: number = price.bid * sharesToSell - COMMISSION;\r\n      const msg: string =\r\n        \"Please confirm sale of \" +\r\n        sharesToSell +\r\n        \" shares of \" +\r\n        asset.stock.name +\r\n        \" for a total of \" +\r\n        formatCurrency(totalCost) +\r\n        \".\";\r\n      const isOK: boolean = window.confirm(msg);\r\n\r\n      if (isOK) {\r\n        const response = await sellAsset(\r\n          asset.stock.symbol,\r\n          sharesToSell,\r\n          price.bid || 0\r\n        );\r\n        if (response) {\r\n          window.alert(\r\n            \"Sale confirmed. New cash balance is \" +\r\n              formatCurrency(response.remainingCash)\r\n          );\r\n          window.location.assign(\"/\");\r\n        } else {\r\n          window.alert(\"Sale failed: \" + response);\r\n        }\r\n      } else alert(\"Sale cancelled\");\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    setLoadingAssets(true);\r\n    getAssets().then((foundAssets) => {\r\n      setAssets(foundAssets);\r\n      setLoadingAssets(false);\r\n      if (foundAssets && foundAssets.length > 0) setAsset(foundAssets[0]);\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (asset) {\r\n      setLoadingPrice(true);\r\n      setSharesToSell(0);\r\n\r\n      getStockPrice(asset.stock.symbol).then((foundPrice) => {\r\n        setPrice(foundPrice);\r\n        setLoadingPrice(false);\r\n      });\r\n    }\r\n  }, [asset]);\r\n\r\n  const formItemLayout = {\r\n    labelCol: {\r\n      span: 2,\r\n      offset: 0,\r\n    },\r\n    wrapperCol: {\r\n      span: 6,\r\n      offset: 1,\r\n    },\r\n  };\r\n  const tailLayout = {\r\n    wrapperCol: {\r\n      offset: 3,\r\n      span: 16,\r\n    },\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {loadingAssets ? (\r\n        <Spin size=\"large\" />\r\n      ) : !assets || assets.length == 0 ? (\r\n        <Empty description=\"You do not have any stocks to sell\"></Empty>\r\n      ) : (\r\n        <Form name=\"sell\" {...formItemLayout}>\r\n          <Form.Item label=\"Stock\">\r\n            <Select\r\n              onChange={handleAssetChange}\r\n              defaultValue={assets[0].stock.symbol}\r\n              value={asset?.stock.symbol}\r\n            >\r\n              {assets.map((currAsset) => {\r\n                return (\r\n                  <Select.Option value={currAsset.stock.symbol}>\r\n                    {currAsset.stock.name +\r\n                      \"  (\" +\r\n                      currAsset.stock.symbol +\r\n                      \")\"}\r\n                  </Select.Option>\r\n                );\r\n              })}\r\n            </Select>\r\n          </Form.Item>\r\n\r\n          <Form.Item label=\"Current Bid Price\">\r\n            {loadingPrice ? (\r\n              <Spin size=\"small\" />\r\n            ) : (\r\n              <label> {formatCurrency(price.bid)}</label>\r\n            )}\r\n          </Form.Item>\r\n\r\n          <Form.Item label=\"Shares to Sell\">\r\n            <Input\r\n              placeholder={\r\n                asset\r\n                  ? \"\" +\r\n                    getShareCount(asset) +\r\n                    \" shares of \" +\r\n                    asset.stock.symbol +\r\n                    \" available to sell\"\r\n                  : \"Enter number of shares to sell\"\r\n              }\r\n              onChange={handleSharesToSell}\r\n              value={sharesToSell == 0 ? undefined : sharesToSell}\r\n              style={\r\n                sharesToSell > getShareCount(asset)\r\n                  ? { color: \"red\" }\r\n                  : { color: undefined }\r\n              }\r\n            ></Input>\r\n          </Form.Item>\r\n\r\n          <Form.Item label=\"Commission\">\r\n            <label>{formatCurrency(COMMISSION)}</label>\r\n          </Form.Item>\r\n\r\n          <Form.Item label=\"Net Proceeds\">\r\n            {loadingPrice && sharesToSell > 0 ? (\r\n              <Spin size=\"small\" />\r\n            ) : (\r\n              <label>\r\n                {sharesToSell > getShareCount(asset)\r\n                  ? \"You may sell a maximum of \" +\r\n                    getShareCount(asset) +\r\n                    \" shares of \" +\r\n                    asset?.stock.symbol\r\n                  : sharesToSell == 0\r\n                  ? \"Please enter the number of shares to sell\"\r\n                  : sharesToSell > 0\r\n                  ? formatCurrency(price.bid * sharesToSell - COMMISSION)\r\n                  : 0}\r\n              </label>\r\n            )}\r\n          </Form.Item>\r\n\r\n          <Form.Item {...tailLayout}>\r\n            <Button\r\n              type=\"primary\"\r\n              onClick={handleSale}\r\n              disabled={\r\n                !asset ||\r\n                !price ||\r\n                sharesToSell <= 0 ||\r\n                sharesToSell > getShareCount(asset)\r\n              }\r\n            >\r\n              Submit\r\n            </Button>\r\n          </Form.Item>\r\n        </Form>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n","import { useEffect, useState } from \"react\";\r\nimport { getTransactions } from \"../APIService\";\r\nimport { Transaction, TransactionType, Account } from \"../types\";\r\nimport { Spin, Table, TablePaginationConfig } from \"antd\";\r\nimport { calcSharePrice, formatCurrency, formatDate } from \"../Calculations\";\r\n\r\ntype TransactionRow = {\r\n  date: string;\r\n  description: string;\r\n  amount: string;\r\n  cash: string;\r\n};\r\n\r\nfunction Transactions() {\r\n  const [data, setData] = useState<TransactionRow[] | undefined>();\r\n\r\n  useEffect(() => {\r\n    getTransactions().then((transactions) => {\r\n      setData(calcData(transactions));\r\n    });\r\n  }, []);\r\n\r\n  const calcData = (transactions: Transaction[]): TransactionRow[] => {\r\n    const rows: TransactionRow[] = [];\r\n    for (var transaction of transactions) {\r\n      rows.push({\r\n        date: formatDate(transaction.date, true),\r\n        description: createDescription(transaction),\r\n        amount: transaction.amount? formatCurrency(transaction.amount) : formatCurrency(0),\r\n        cash: formatCurrency(transaction.cash),\r\n      });\r\n    }\r\n    return rows;\r\n  };\r\n\r\n  const createDescription = (transaction: Transaction) => {\r\n    var description: string = \"\";\r\n\r\n    switch (transaction.type) {\r\n      case TransactionType.BUY:\r\n        description =\r\n          \"Buy \" +\r\n          transaction.shares +\r\n          \" of \" +\r\n          transaction.name +\r\n          \" (\" +\r\n          transaction.symbol +\r\n          \") at \" +\r\n          formatCurrency(calcSharePrice(transaction))\r\n        break;\r\n\r\n      case TransactionType.DIVIDEND:\r\n        description =\r\n          \"Dividend on \" +\r\n          transaction.shares +\r\n          \" shares of \" +\r\n          transaction.name +\r\n          \" (\" +\r\n          transaction.symbol +\r\n          \")\";\r\n        break;\r\n\r\n      case TransactionType.GIFT:\r\n        description = \"Initial Deposit\";\r\n        break;\r\n      case TransactionType.SELL:\r\n        description =\r\n          \"Sell \" +\r\n          transaction.shares +\r\n          \" of \" +\r\n          transaction.name +\r\n          \" (\" +\r\n          transaction.symbol +\r\n          \") at \" +\r\n          formatCurrency(calcSharePrice(transaction))\r\n        break;\r\n      case TransactionType.SPLIT:\r\n        description = transaction.symbol + \" \" + transaction.to + \"-for-\" + transaction.from + \" Stock Split\"\r\n        break;\r\n      default:\r\n        console.log(\"This is transaction type: \" + transaction.type);\r\n        description = \"There is no describing this transaction\";\r\n        break;\r\n    }\r\n\r\n    //console.log(\"Description for \", transaction, \" -> \", description);\r\n    return description;\r\n  };\r\n\r\n  const columns: object[] = [\r\n    { title: \"Date\", dataIndex: \"date\", key: \"date\" },\r\n    { title: \"Description\", dataIndex: \"description\", key: \"description\" },\r\n    { title: \"Amount\", dataIndex: \"amount\", key: \"amount\" },\r\n    { title: \"Cash Balance\", dataIndex: \"cash\", key: \"cash\" },\r\n  ];\r\n\r\n  const tablePaginationConfig:TablePaginationConfig = {\r\n    pageSize : 100\r\n  }\r\n\r\n  return (\r\n    <div className=\"Transactions\">\r\n      <header className=\"Transactions-header\"></header>\r\n      {data === undefined ? (\r\n        <Spin size = \"default\" />\r\n      ) : (\r\n        <Table \r\n        dataSource={data} \r\n        columns={columns} \r\n        pagination={tablePaginationConfig}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Transactions;\r\n","import { Button, Tabs } from \"antd\";\r\nimport \"antd/dist/antd.css\";\r\nimport { doLogout } from \"../APIService\";\r\nimport Analysis from \"./Analysis\";\r\nimport Overview from \"./Overview\";\r\nimport Positions from \"./Positions\";\r\nimport Trade from \"./Trade\";\r\nimport Transactions from \"./Transactions\";\r\n\r\nconst { TabPane } = Tabs;\r\n\r\nconst handleLogout = () => {\r\n  const isOK: boolean = window.confirm(\"OK to Log Out?\");\r\n  if (!isOK) return;\r\n  doLogout();\r\n  window.location.assign(\"/login\");\r\n};\r\nconst logoutButton = (\r\n  <Button type=\"primary\" onClick={handleLogout}>\r\n    Logout\r\n  </Button>\r\n);\r\n\r\nconst style = {\r\n  \r\n}\r\n\r\nfunction NavPane() {\r\n  return (\r\n    <Tabs style={{\r\n    paddingTop: '5px',\r\n    paddingLeft: '10px',\r\n    paddingRight: '5px',\r\n    boxSizing: 'content-box',\r\n  }} tabBarExtraContent={logoutButton}\r\n  tabPosition='top'\r\n  type='card'\r\n  >\r\n      <TabPane tab=\"Overview\" key=\"1\">\r\n        <Overview />\r\n      </TabPane>\r\n      <TabPane tab=\"Positions\" key=\"2\">\r\n        <Positions />\r\n      </TabPane>\r\n      <TabPane tab=\"Transactions\" key=\"3\">\r\n        <Transactions />\r\n      </TabPane>\r\n      <TabPane tab=\"Analysis\" key=\"4\">\r\n        <Analysis />\r\n      </TabPane>\r\n      <TabPane tab=\"Trade\" key=\"5\">\r\n        <Trade />\r\n      </TabPane>\r\n    </Tabs>\r\n  );\r\n}\r\n\r\nexport default NavPane;\r\n","\r\nimport { Button, Form, Input } from \"antd\";\r\nimport { doSignup } from \"../APIService\";\r\n\r\nfunction SignUp() {\r\n  const handleSignUpButtonClick = (values: any) => {\r\n    doSignup(values.userID, values.password, values.name).then(\r\n      (success: boolean) => {\r\n        if (success) {\r\n          window.location.assign(\"/login\");\r\n          window.alert(\r\n            \"Welcome, \" +\r\n              values.name +\r\n              \". Your account was successfully created.\"\r\n          );\r\n        } else {\r\n          window.alert(\"Error creating account\");\r\n        }\r\n      }\r\n    );\r\n  };\r\n\r\n  const formItemLayout = {\r\n    labelCol: {\r\n      span: 2,\r\n      offset: 0,\r\n    },\r\n    wrapperCol: {\r\n      span: 10,\r\n      offset: 1,\r\n    },\r\n  };\r\n\r\n  return (\r\n    <Form name=\"signup\" {...formItemLayout} onFinish={handleSignUpButtonClick}>\r\n      <Form.Item\r\n        label=\"Name\"\r\n        name=\"name\"\r\n        rules={[\r\n          {\r\n            required: true,\r\n            message: \"Please input your name\",\r\n          },\r\n        ]}\r\n      >\r\n        <Input placeholder=\"Fred Smith\" />\r\n      </Form.Item>\r\n      <Form.Item\r\n        label=\"User ID\"\r\n        name=\"userID\"\r\n        rules={[\r\n          {\r\n            required: true,\r\n            message: \"Please input your user ID\",\r\n          },\r\n        ]}\r\n      >\r\n        <Input placeholder=\"stock-market-whiz\" />\r\n      </Form.Item>\r\n\r\n      <Form.Item\r\n        label=\"Password\"\r\n        name=\"password\"\r\n        rules={[\r\n          {\r\n            required: true,\r\n            message: \"Please input your password\",\r\n          },\r\n        ]}\r\n      >\r\n        <Input.Password autoComplete=\"new-password\" />\r\n      </Form.Item>\r\n      <Form.Item\r\n        wrapperCol={{\r\n          offset: 8,\r\n          span: 3,\r\n        }}\r\n      >\r\n        <Button type=\"primary\" htmlType=\"submit\">\r\n          Sign Up\r\n        </Button>\r\n      </Form.Item>\r\n    </Form>\r\n  );\r\n}\r\n\r\nexport default SignUp;\r\n","import Login from \"./scenes/Login\";\r\nimport Header from \"./components/Header\";\r\n\r\nimport {isLoggedIn } from \"./APIService\";\r\nimport NavPane from \"./scenes/NavPane\";\r\nimport { BrowserRouter as Router, Route, Switch } from \"react-router-dom\";\r\nimport SignUp from \"./scenes/SignUp\";\r\n\r\nexport default function App() {\r\n  return (\r\n    <Router>\r\n      <div>\r\n        <Header />\r\n        <br/>\r\n        <Switch>\r\n          <Route path=\"/signup\">\r\n            <SignUp />\r\n          </Route>\r\n          <Route path=\"/login\">\r\n            {!isLoggedIn() ? (\r\n              <Login/>\r\n            ) : (\r\n              <NavPane />\r\n            )}\r\n          </Route>\r\n      \r\n          <Route path=\"/\">\r\n            {!isLoggedIn() ? (\r\n              <Login/>\r\n            ) : (\r\n              <NavPane />\r\n            )}\r\n          </Route>\r\n        </Switch>\r\n      </div>\r\n    </Router>\r\n  );\r\n}","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}